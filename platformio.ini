[env:esp32dev]
platform = espressif32@6.7.0
board = esp32dev
framework = arduino
monitor_speed = 115200
upload_speed = 921600
upload_protocol = esptool

; Build flags - ALL COMBINED IN ONE SECTION
build_flags =
    -DCORE_DEBUG_LEVEL=2
    -DMODEM_RX_PIN=16
    -DMODEM_TX_PIN=17
    -DCAN1_RX_PIN=22
    -DCAN1_TX_PIN=21
    -DCAN2_RX_PIN=35
    -DCAN2_TX_PIN=33
    -DMODEM_DTR_PIN=4
    -DMODEM_EN_PIN=27
    -DMODEM_NET_PIN=26
    -DLED_PIN=2
    -DMQTT_MAX_PACKET_SIZE=4096
    -Wno-missing-field-initializers
    -Wno-error=format
    -Wno-error=unused-variable
    -Wno-error=unused-but-set-variable

; Required libraries for ESP32 + LTE/CAN/MQTT
lib_deps =
    PubSubClient@2.8
    ArduinoJson@6.21.4

; Serial Monitor filters
monitor_filters =
    esp32_exception_decoder
    time

; Board-specific settings
board_build.f_cpu = 240000000L
board_build.f_flash = 40000000L
board_build.flash_mode = dio
board_build.flash_size = 4MB

; ============================================================================
; LITTLEFS FILESYSTEM SUPPORT (NEW for Phase 1)
; ============================================================================
; Enable LittleFS for persistent configuration storage
board_build.filesystem = littlefs
board_build.partitions = default.csv

; Files from 'data' directory will be uploaded to LittleFS
; Upload filesystem with: pio run -t uploadfs
board_build.littlefs_start = 0x290000
board_build.littlefs_page_size = 256
board_build.littlefs_block_size = 4096

; Increase filesystem space allocation (important for settings storage)
; Default partitions divide storage, we need space for settings.json + future files
board_build.partitions = partitions.csv

; ============================================================================
; OPTIONAL: OTA update settings
; ============================================================================
; Uncomment to enable OTA updates
; upload_port = 192.168.1.100
; upload_protocol = espota
; upload_port = COM3  ; Windows
; upload_port = /dev/ttyUSB0  ; Linux

; ============================================================================
; DEBUGGING & MONITORING
; ============================================================================
; Enable verbose output
; build_flags =
;     ${env:esp32dev.build_flags}
;     -v

; Additional debugging
; debug_tool = esp-prog
; debug_port = /dev/ttyUSB0
